{
  "metadata": {
    "total_cells": 13,
    "notebook_path": "TDS_Automation_V2.ipynb",
    "last_scan": "2025-08-14T10:32:31.272614",
    "version": "3.0",
    "repository": "rjshvjy/tds-automation",
    "type": "widget_based",
    "flow_type": "branching",
    "commit_hash": "3186fcbce94ffe3bb05fb87462971d03e08819ef"
  },
  "cells": {
    "cell_1": {
      "index": 1,
      "title": "Install required libraries and import modules",
      "status": "unknown",
      "imports": [
        "import PyPDF2",
        "import pandas as pd",
        "import numpy as np",
        "import re",
        "import os",
        "from datetime import datetime",
        "import openpyxl",
        "from openpyxl import load_workbook",
        "from openpyxl.utils import get_column_letter",
        "from openpyxl.styles import Font, Alignment, Border, Side",
        "import warnings"
      ],
      "defines": {
        "functions": [],
        "classes": []
      },
      "calls": [
        "filterwarnings",
        "print"
      ],
      "dependencies": {
        "backward": [],
        "forward": []
      },
      "issues": [],
      "mapping_related": false
    },
    "cell_2": {
      "index": 2,
      "title": "Functions to extract data from PDF challans - FIXED AMOUNT EXTRACTION",
      "status": "unknown",
      "imports": [],
      "defines": {
        "functions": [
          "extract_challan_data_from_pdf",
          "extract_all_challans",
          "test_extraction"
        ],
        "classes": []
      },
      "calls": [
        "PdfReader",
        "extract_text",
        "lower",
        "sorted",
        "extract_challan_data_from_pdf",
        "replace",
        "str",
        "listdir",
        "upper",
        "items",
        "group",
        "len",
        "join",
        "get",
        "search",
        "open",
        "test_extraction",
        "basename",
        "print",
        "endswith",
        "zfill",
        "strip",
        "float",
        "append",
        "extract_all_challans"
      ],
      "dependencies": {
        "backward": [],
        "forward": []
      },
      "issues": [
        "Contains leading_zeros pattern",
        "Contains string_preserve pattern"
      ],
      "mapping_related": true
    },
    "cell_3": {
      "index": 3,
      "title": "Functions to read and update Excel files - FIXED WITH PROPER COLUMN CODES AND TDS PRESERVATION",
      "status": "unknown",
      "imports": [
        "import math",
        "from decimal import Decimal, ROUND_HALF_UP",
        "import traceback",
        "import traceback",
        "import traceback"
      ],
      "defines": {
        "functions": [
          "read_tds_masters",
          "update_tds_masters_with_challans",
          "validate_tds_totals"
        ],
        "classes": []
      },
      "calls": [
        "cell",
        "any",
        "lower",
        "sorted",
        "replace",
        "str",
        "iterrows",
        "DataFrame",
        "list",
        "enumerate",
        "items",
        "save",
        "group",
        "read_excel",
        "len",
        "range",
        "quantize",
        "set",
        "Decimal",
        "get",
        "strptime",
        "abs",
        "update_tds_masters_with_challans",
        "search",
        "apply",
        "notna",
        "match",
        "to_numeric",
        "print_exc",
        "close",
        "startswith",
        "print",
        "min",
        "iter_rows",
        "validate_tds_totals",
        "to_datetime",
        "strip",
        "load_workbook",
        "int",
        "astype",
        "append",
        "keys",
        "read_tds_masters"
      ],
      "dependencies": {
        "backward": [],
        "forward": []
      },
      "issues": [
        "Contains nan_values pattern",
        "Contains date_format pattern",
        "Contains rate_conversion pattern",
        "Contains round_up pattern",
        "Contains string_preserve pattern"
      ],
      "mapping_related": true,
      "column_references": [
        "(415)",
        "(415A)",
        "(416)",
        "(417)",
        "(418)",
        "(419)",
        "(421)",
        "(425D)",
        "(425E)",
        "(425F)",
        "(427)"
      ]
    },
    "cell_4": {
      "index": 4,
      "title": "TDS_Masters Template Generator",
      "status": "unknown",
      "imports": [
        "import openpyxl",
        "from openpyxl import Workbook",
        "from openpyxl.styles import Font, Alignment, Border, Side, PatternFill",
        "from openpyxl.utils import get_column_letter",
        "from openpyxl.worksheet.datavalidation import DataValidation",
        "import pandas as pd",
        "from datetime import datetime",
        "import ipywidgets as widgets",
        "from IPython.display import display",
        "from google.colab import files"
      ],
      "defines": {
        "functions": [
          "generate_tds_masters_template",
          "create_template_download_widget"
        ],
        "classes": [
          "TDSMastersTemplateGenerator"
        ]
      },
      "calls": [
        "cell",
        "Layout",
        "_setup_tds_rates_sheet",
        "now",
        "DataValidation",
        "create_sheet",
        "TDSMastersTemplateGenerator",
        "_setup_tds_parties_sheet",
        "details",
        "HTML",
        "enumerate",
        "on_click",
        "_setup_tds_codes_sheet",
        "Comment",
        "items",
        "save",
        "create_template",
        "range",
        "Alignment",
        "_setup_deductor_input_sheet",
        "download",
        "get_column_letter",
        "VBox",
        "download_template",
        "Workbook",
        "__init__",
        "add_data_validation",
        "_setup_challan_details_sheet",
        "PatternFill",
        "print",
        "generate_tds_masters_template",
        "Font",
        "create_template_download_widget",
        "Button",
        "merge_cells",
        "add",
        "save_template",
        "date"
      ],
      "dependencies": {
        "backward": [],
        "forward": []
      },
      "issues": [
        "Contains nan_values pattern",
        "Contains leading_zeros pattern",
        "Contains date_format pattern",
        "Contains rate_conversion pattern"
      ],
      "mapping_related": false,
      "column_references": [
        "(415)",
        "(415A)",
        "(416)",
        "(417)",
        "(418)",
        "(419)",
        "(420)",
        "(421)",
        "(425D)",
        "(425E)",
        "(425F)",
        "(427)"
      ]
    },
    "cell_5": {
      "index": 5,
      "title": "Government Template Builder and Enhanced Output Generator",
      "status": "unknown",
      "imports": [
        "import openpyxl",
        "from openpyxl import Workbook",
        "from openpyxl.styles import Font, Alignment, Border, Side, PatternFill",
        "from openpyxl.utils import get_column_letter",
        "from decimal import Decimal, ROUND_HALF_UP",
        "import pandas as pd",
        "from datetime import datetime",
        "import math"
      ],
      "defines": {
        "functions": [
          "generate_output_file_enhanced",
          "test_template_generation"
        ],
        "classes": [
          "GovernmentTemplateBuilder"
        ]
      },
      "calls": [
        "cell",
        "dropna",
        "create_sheet",
        "test_template_generation",
        "_fill_deductee_breakup",
        "replace",
        "_fill_deductor_details",
        "iterrows",
        "str",
        "upper",
        "GovernmentTemplateBuilder",
        "enumerate",
        "_fill_challan_details",
        "save",
        "_setup_deductor_sheet",
        "create_template",
        "len",
        "Alignment",
        "generate_output_file_enhanced",
        "fill_template",
        "get",
        "get_column_letter",
        "strptime",
        "notna",
        "Workbook",
        "__init__",
        "print",
        "isinstance",
        "Font",
        "to_datetime",
        "if",
        "strip",
        "_setup_challan_sheet",
        "float",
        "int",
        "ceil",
        "append",
        "_setup_deductee_sheet",
        "extract_all_challans",
        "read_tds_masters"
      ],
      "dependencies": {
        "backward": [
          "cell_3",
          "cell_2"
        ],
        "forward": [
          "cell_9"
        ]
      },
      "issues": [
        "Contains nan_values pattern",
        "Contains date_format pattern",
        "Contains rate_conversion pattern",
        "Contains round_up pattern",
        "Contains string_preserve pattern"
      ],
      "mapping_related": true,
      "column_references": [
        "(415)",
        "(415A)",
        "(416)",
        "(417)",
        "(418)",
        "(419)",
        "(420)",
        "(421)",
        "(425D)",
        "(425E)",
        "(425F)",
        "(427)"
      ]
    },
    "cell_6": {
      "index": 6,
      "title": "Enhanced Main Processing Pipeline",
      "status": "unknown",
      "imports": [
        "import os",
        "import math",
        "import pandas as pd",
        "import numpy as np",
        "from datetime import datetime",
        "from decimal import Decimal, ROUND_HALF_UP",
        "import openpyxl",
        "from openpyxl import load_workbook, Workbook",
        "from openpyxl.utils import get_column_letter",
        "from openpyxl.styles import Font, Alignment, Border, Side, PatternFill",
        "from GovernmentTemplateBuilder import GovernmentTemplateBuilder",
        "from GovernmentTemplateBuilder import GovernmentTemplateBuilder"
      ],
      "defines": {
        "functions": [
          "get_output_filename_from_masters",
          "fill_government_template",
          "process_tds_returns_enhanced",
          "process_tds_returns"
        ],
        "classes": []
      },
      "calls": [
        "dropna",
        "now",
        "object",
        "create_sheet",
        "process_tds_returns_enhanced",
        "validate_all",
        "GovernmentTemplateBuilder",
        "generate_report",
        "save",
        "process_tds_returns",
        "create_template",
        "get_output_filename_from_masters",
        "len",
        "join",
        "ReconciliationReport",
        "fill_template",
        "get",
        "update_tds_masters_with_challans",
        "Workbook",
        "remove",
        "print",
        "fill_government_template",
        "ImportError",
        "validate_tds_totals",
        "to_datetime",
        "ValidationEngine",
        "dirname",
        "strftime",
        "extract_all_challans",
        "read_tds_masters"
      ],
      "dependencies": {
        "backward": [
          "cell_3",
          "cell_5",
          "cell_2"
        ],
        "forward": [
          "cell_8",
          "cell_9",
          "cell_7"
        ]
      },
      "issues": [
        "Contains date_format pattern",
        "Contains rate_conversion pattern",
        "Contains round_up pattern",
        "Contains string_preserve pattern"
      ],
      "mapping_related": true,
      "column_references": [
        "(418)"
      ]
    },
    "cell_7": {
      "index": 7,
      "title": "Validation Engine with Reconciliation Report Support",
      "status": "unknown",
      "imports": [
        "import re",
        "import pandas as pd",
        "import openpyxl",
        "from openpyxl import load_workbook",
        "from datetime import datetime",
        "from decimal import Decimal, ROUND_HALF_UP",
        "import numpy as np"
      ],
      "defines": {
        "functions": [
          "test_validation"
        ],
        "classes": [
          "ValidationEngine"
        ]
      },
      "calls": [
        "_validate_tan",
        "_validate_pincode",
        "now",
        "sorted",
        "validate_all",
        "_validate_pan",
        "replace",
        "str",
        "iterrows",
        "upper",
        "DataFrame",
        "list",
        "enumerate",
        "_validate_formats",
        "items",
        "strftime",
        "_validate_yes_no",
        "len",
        "quantize",
        "values",
        "set",
        "Decimal",
        "get",
        "abs",
        "ExcelWriter",
        "notna",
        "match",
        "sum",
        "_validate_email",
        "__init__",
        "_validate_quarter",
        "print",
        "_validate_deductor_type",
        "test_validation",
        "to_string",
        "ValidationEngine",
        "_generate_summary",
        "strip",
        "load_workbook",
        "_load_deductor_details",
        "float",
        "export_validation_report",
        "_validate_mandatory_fields",
        "validator",
        "get_validation_dataframe",
        "to_excel",
        "append",
        "keys",
        "title",
        "_generate_suggestions",
        "_reconcile_amounts"
      ],
      "dependencies": {
        "backward": [],
        "forward": []
      },
      "issues": [
        "Contains nan_values pattern",
        "Contains date_format pattern",
        "Contains rate_conversion pattern",
        "Contains round_up pattern",
        "Contains string_preserve pattern"
      ],
      "mapping_related": true,
      "column_references": [
        "(415A)",
        "(416)",
        "(417)",
        "(421)"
      ]
    },
    "cell_8": {
      "index": 8,
      "title": "Reconciliation Report Generator",
      "status": "unknown",
      "imports": [
        "import pandas as pd",
        "import openpyxl",
        "from openpyxl import Workbook",
        "from openpyxl.styles import Font, Alignment, Border, Side, PatternFill",
        "from openpyxl.utils import get_column_letter",
        "from openpyxl.formatting.rule import CellIsRule",
        "from openpyxl.styles.differential import DifferentialStyle",
        "from datetime import datetime",
        "import numpy as np"
      ],
      "defines": {
        "functions": [
          "test_reconciliation_report"
        ],
        "classes": [
          "ReconciliationReport"
        ]
      },
      "calls": [
        "cell",
        "now",
        "create_sheet",
        "Side",
        "append",
        "_create_data_corrections_sheet",
        "generate_report",
        "enumerate",
        "save",
        "items",
        "len",
        "range",
        "Alignment",
        "_create_mandatory_fields_sheet",
        "values",
        "abs",
        "get",
        "ReconciliationReport",
        "_create_challan_matching_sheet",
        "_print_report_summary",
        "_create_validation_errors_sheet",
        "sum",
        "Workbook",
        "__init__",
        "else",
        "remove",
        "PatternFill",
        "print",
        "test_reconciliation_report",
        "Font",
        "_create_summary_sheet",
        "merge_cells",
        "_get_format_suggestion",
        "Border",
        "strftime",
        "title"
      ],
      "dependencies": {
        "backward": [],
        "forward": []
      },
      "issues": [
        "Contains date_format pattern",
        "Contains rate_conversion pattern"
      ],
      "mapping_related": true,
      "column_references": [
        "(416)",
        "(417)"
      ]
    },
    "cell_9": {
      "index": 9,
      "title": "Enhanced Main Processing Pipeline",
      "status": "unknown",
      "imports": [
        "import os",
        "import math",
        "import pandas as pd",
        "import numpy as np",
        "from datetime import datetime",
        "from decimal import Decimal, ROUND_HALF_UP",
        "import openpyxl",
        "from openpyxl import load_workbook, Workbook",
        "from openpyxl.utils import get_column_letter",
        "from openpyxl.styles import Font, Alignment, Border, Side, PatternFill"
      ],
      "defines": {
        "functions": [
          "get_output_filename_from_masters",
          "fill_government_template",
          "_fill_deductor_details",
          "_fill_challan_details",
          "_fill_deductee_breakup",
          "process_tds_returns_enhanced",
          "process_tds_returns"
        ],
        "classes": []
      },
      "calls": [
        "cell",
        "dropna",
        "now",
        "to_pydatetime",
        "create_sheet",
        "process_tds_returns_enhanced",
        "validate_all",
        "_fill_deductee_breakup",
        "replace",
        "_fill_deductor_details",
        "str",
        "iterrows",
        "GovernmentTemplateBuilder",
        "generate_report",
        "enumerate",
        "_fill_challan_details",
        "save",
        "process_tds_returns",
        "create_template",
        "get_output_filename_from_masters",
        "range",
        "quantize",
        "len",
        "join",
        "Decimal",
        "get",
        "strptime",
        "fill_template",
        "ReconciliationReport",
        "update_tds_masters_with_challans",
        "notna",
        "Workbook",
        "remove",
        "print",
        "isinstance",
        "fill_government_template",
        "validate_tds_totals",
        "Font",
        "to_datetime",
        "strip",
        "ValidationEngine",
        "float",
        "dirname",
        "int",
        "strftime",
        "extract_all_challans",
        "read_tds_masters"
      ],
      "dependencies": {
        "backward": [
          "cell_3",
          "cell_2",
          "cell_8",
          "cell_7",
          "cell_5"
        ],
        "forward": []
      },
      "issues": [
        "Contains nan_values pattern",
        "Contains date_format pattern",
        "Contains rate_conversion pattern",
        "Contains round_up pattern",
        "Contains string_preserve pattern"
      ],
      "mapping_related": true,
      "column_references": [
        "(415)",
        "(415A)",
        "(416)",
        "(417)",
        "(418)",
        "(419)",
        "(420)",
        "(421)",
        "(425D)",
        "(427)"
      ]
    },
    "cell_10": {
      "index": 10,
      "title": "Modified Interactive Interface - 2-File Upload System",
      "status": "unknown",
      "imports": [
        "import os",
        "import zipfile",
        "import shutil",
        "from google.colab import files",
        "import pandas as pd",
        "from datetime import datetime",
        "import time",
        "import traceback"
      ],
      "defines": {
        "functions": [
          "clear_uploads",
          "upload_zip_file",
          "process_uploaded_files",
          "start_interactive_upload",
          "download_tds_masters_template"
        ],
        "classes": []
      },
      "calls": [
        "clear_uploads",
        "lower",
        "ZipFile",
        "start_interactive_upload",
        "TDSMastersTemplateGenerator",
        "walk",
        "process_tds_returns_enhanced",
        "extract_challan_data_from_pdf",
        "upload_zip_file",
        "items",
        "write",
        "move",
        "format",
        "save",
        "len",
        "rmtree",
        "create_template",
        "join",
        "download",
        "get",
        "makedirs",
        "open",
        "process_uploaded_files",
        "print_exc",
        "remove",
        "startswith",
        "basename",
        "print",
        "endswith",
        "extractall",
        "upload",
        "download_tds_masters_template",
        "exists",
        "append"
      ],
      "dependencies": {
        "backward": [
          "cell_9",
          "cell_4",
          "cell_2"
        ],
        "forward": []
      },
      "issues": [
        "Contains leading_zeros pattern",
        "Contains rate_conversion pattern",
        "Contains round_up pattern",
        "Contains string_preserve pattern"
      ],
      "mapping_related": true,
      "column_references": [
        "(427)"
      ]
    },
    "cell_11": {
      "index": 11,
      "title": "Testing individual components and troubleshooting - FIXED VERSION",
      "status": "unknown",
      "imports": [
        "from collections import Counter"
      ],
      "defines": {
        "functions": [
          "test_pdf_extraction_single",
          "test_pdf_deduplication",
          "test_tds_masters_reading",
          "test_date_extraction",
          "create_test_summary"
        ],
        "classes": []
      },
      "calls": [
        "dropna",
        "lower",
        "sorted",
        "extract_challan_data_from_pdf",
        "replace",
        "iterrows",
        "listdir",
        "test_pdf_extraction_single",
        "str",
        "enumerate",
        "items",
        "Counter",
        "test_tds_masters_reading",
        "get_output_filename_from_masters",
        "test_date_extraction",
        "join",
        "abs",
        "get",
        "test_pdf_deduplication",
        "notna",
        "print",
        "endswith",
        "head",
        "to_datetime",
        "strip",
        "float",
        "create_test_summary",
        "most_common",
        "append",
        "ceil",
        "extract_all_challans",
        "read_tds_masters"
      ],
      "dependencies": {
        "backward": [
          "cell_3",
          "cell_9",
          "cell_2"
        ],
        "forward": []
      },
      "issues": [
        "Contains nan_values pattern",
        "Contains leading_zeros pattern",
        "Contains date_format pattern",
        "Contains rate_conversion pattern",
        "Contains round_up pattern",
        "Contains string_preserve pattern"
      ],
      "mapping_related": true,
      "column_references": [
        "(415)",
        "(415A)",
        "(416)",
        "(417)",
        "(418)",
        "(419)",
        "(421)",
        "(427)"
      ]
    },
    "cell_12": {
      "index": 12,
      "title": "Main Execution Cell - Simple Interface",
      "status": "unknown",
      "imports": [],
      "defines": {
        "functions": [
          "quick_start"
        ],
        "classes": []
      },
      "calls": [
        "quick_start",
        "start_interactive_upload",
        "len",
        "exists",
        "print",
        "endswith",
        "get",
        "listdir"
      ],
      "dependencies": {
        "backward": [
          "cell_10"
        ],
        "forward": []
      },
      "issues": [],
      "mapping_related": false
    }
  },
  "dependency_graph": {
    "execution_order": [
      1,
      2,
      3,
      4,
      5,
      6,
      7,
      8,
      9,
      10,
      11,
      12
    ],
    "definitions": {
      "extract_challan_data_from_pdf": "cell_2",
      "extract_all_challans": "cell_2",
      "test_extraction": "cell_2",
      "read_tds_masters": "cell_3",
      "update_tds_masters_with_challans": "cell_3",
      "validate_tds_totals": "cell_3",
      "generate_tds_masters_template": "cell_4",
      "create_template_download_widget": "cell_4",
      "TDSMastersTemplateGenerator": "cell_4",
      "generate_output_file_enhanced": "cell_5",
      "test_template_generation": "cell_5",
      "GovernmentTemplateBuilder": "cell_5",
      "get_output_filename_from_masters": "cell_9",
      "fill_government_template": "cell_9",
      "process_tds_returns_enhanced": "cell_9",
      "process_tds_returns": "cell_9",
      "test_validation": "cell_7",
      "ValidationEngine": "cell_7",
      "test_reconciliation_report": "cell_8",
      "ReconciliationReport": "cell_8",
      "_fill_deductor_details": "cell_9",
      "_fill_challan_details": "cell_9",
      "_fill_deductee_breakup": "cell_9",
      "clear_uploads": "cell_10",
      "upload_zip_file": "cell_10",
      "process_uploaded_files": "cell_10",
      "start_interactive_upload": "cell_10",
      "download_tds_masters_template": "cell_10",
      "test_pdf_extraction_single": "cell_11",
      "test_pdf_deduplication": "cell_11",
      "test_tds_masters_reading": "cell_11",
      "test_date_extraction": "cell_11",
      "create_test_summary": "cell_11",
      "quick_start": "cell_12"
    },
    "forward_dependencies": 2
  },
  "mapping_pipeline": {
    "pdf_extraction": {
      "functions": [
        {
          "cell": "cell_2",
          "functions": [
            "extract_challan_data_from_pdf",
            "extract_all_challans",
            "test_extraction"
          ]
        },
        {
          "cell": "cell_10",
          "functions": [
            "clear_uploads",
            "upload_zip_file",
            "process_uploaded_files",
            "start_interactive_upload",
            "download_tds_masters_template"
          ]
        },
        {
          "cell": "cell_11",
          "functions": [
            "test_pdf_extraction_single",
            "test_pdf_deduplication",
            "test_tds_masters_reading",
            "test_date_extraction",
            "create_test_summary"
          ]
        }
      ],
      "input_fields": [
        "bsr_code",
        "challan_no",
        "bsr_code",
        "challan_no",
        "bsr_code",
        "challan_no",
        "challan_no",
        "challan_no",
        "challan_no",
        "challan_no",
        "challan_no"
      ],
      "output_structure": {},
      "issues": []
    },
    "excel_processing": {
      "functions": [
        {
          "cell": "cell_1",
          "functions": []
        },
        {
          "cell": "cell_3",
          "functions": [
            "read_tds_masters",
            "update_tds_masters_with_challans",
            "validate_tds_totals"
          ]
        },
        {
          "cell": "cell_4",
          "functions": [
            "generate_tds_masters_template",
            "create_template_download_widget"
          ]
        },
        {
          "cell": "cell_5",
          "functions": [
            "generate_output_file_enhanced",
            "test_template_generation"
          ]
        },
        {
          "cell": "cell_6",
          "functions": [
            "get_output_filename_from_masters",
            "fill_government_template",
            "process_tds_returns_enhanced",
            "process_tds_returns"
          ]
        },
        {
          "cell": "cell_7",
          "functions": [
            "test_validation"
          ]
        },
        {
          "cell": "cell_8",
          "functions": [
            "test_reconciliation_report"
          ]
        },
        {
          "cell": "cell_9",
          "functions": [
            "get_output_filename_from_masters",
            "fill_government_template",
            "_fill_deductor_details",
            "_fill_challan_details",
            "_fill_deductee_breakup",
            "process_tds_returns_enhanced",
            "process_tds_returns"
          ]
        },
        {
          "cell": "cell_10",
          "functions": [
            "clear_uploads",
            "upload_zip_file",
            "process_uploaded_files",
            "start_interactive_upload",
            "download_tds_masters_template"
          ]
        },
        {
          "cell": "cell_11",
          "functions": [
            "test_pdf_extraction_single",
            "test_pdf_deduplication",
            "test_tds_masters_reading",
            "test_date_extraction",
            "create_test_summary"
          ]
        },
        {
          "cell": "cell_12",
          "functions": [
            "quick_start"
          ]
        }
      ],
      "column_mappings": {
        "(415)": "Deductee Code",
        "(415A)": "Section/Nature of Payment",
        "(416)": "PAN",
        "(417)": "Name",
        "(418)": "Date of Payment",
        "(419)": "Amount Paid",
        "(420)": "Paid by Book Entry",
        "(421)": "TDS Amount",
        "(425D)": "BSR Code",
        "(425E)": "Challan Serial No",
        "(425F)": "Date Deposited",
        "(427)": "Rate"
      },
      "transformations": [
        "Amount rounding up",
        "Date formatting",
        "Date formatting",
        "Amount rounding up",
        "Date formatting",
        "Amount rounding up",
        "Date formatting",
        "Amount rounding up",
        "Date formatting",
        "Date formatting",
        "Amount rounding up",
        "Date formatting",
        "Date formatting"
      ],
      "issues": []
    },
    "validation": {
      "mandatory_fields": 20,
      "validation_functions": [
        {
          "cell": "cell_3",
          "functions": [
            "read_tds_masters",
            "update_tds_masters_with_challans",
            "validate_tds_totals"
          ]
        },
        {
          "cell": "cell_6",
          "functions": [
            "get_output_filename_from_masters",
            "fill_government_template",
            "process_tds_returns_enhanced",
            "process_tds_returns"
          ]
        },
        {
          "cell": "cell_7",
          "functions": [
            "test_validation"
          ]
        },
        {
          "cell": "cell_8",
          "functions": [
            "test_reconciliation_report"
          ]
        },
        {
          "cell": "cell_9",
          "functions": [
            "get_output_filename_from_masters",
            "fill_government_template",
            "_fill_deductor_details",
            "_fill_challan_details",
            "_fill_deductee_breakup",
            "process_tds_returns_enhanced",
            "process_tds_returns"
          ]
        }
      ],
      "issues": []
    }
  },
  "issues": {
    "critical": [],
    "warnings": [
      "Cell 5: Forward dependency on _fill_deductee_breakup defined in Cell 9",
      "Cell 5: Forward dependency on _fill_deductor_details defined in Cell 9",
      "Cell 5: Forward dependency on _fill_challan_details defined in Cell 9",
      "Cell 6: Forward dependency on process_tds_returns_enhanced defined in Cell 9",
      "Cell 6: Forward dependency on process_tds_returns defined in Cell 9",
      "Cell 6: Forward dependency on get_output_filename_from_masters defined in Cell 9",
      "Cell 6: Forward dependency on ReconciliationReport defined in Cell 8",
      "Cell 6: Forward dependency on fill_government_template defined in Cell 9",
      "Cell 6: Forward dependency on ValidationEngine defined in Cell 7",
      "Undefined function called: dropna",
      "Undefined function called: sorted",
      "Undefined function called: Side",
      "Undefined function called: iterrows",
      "Undefined function called: write",
      "Undefined function called: move",
      "Undefined function called: download",
      "Undefined function called: fill_template",
      "Undefined function called: makedirs",
      "Undefined function called: match",
      "Undefined function called: to_numeric",
      "Undefined function called: PatternFill",
      "Undefined function called: extractall",
      "Undefined function called: head",
      "Undefined function called: ImportError",
      "Undefined function called: dirname",
      "Undefined function called: validator",
      "Undefined function called: get_validation_dataframe",
      "Undefined function called: to_excel",
      "Undefined function called: keys",
      "Undefined function called: date",
      "Undefined function called: title",
      "Undefined function called: PdfReader",
      "Undefined function called: cell",
      "Undefined function called: now",
      "Undefined function called: lower",
      "Undefined function called: to_pydatetime",
      "Undefined function called: details",
      "Undefined function called: listdir",
      "Undefined function called: upper",
      "Undefined function called: generate_report",
      "Undefined function called: list",
      "Undefined function called: save",
      "Undefined function called: create_template",
      "Undefined function called: values",
      "Undefined function called: abs",
      "Undefined function called: get_column_letter",
      "Undefined function called: else",
      "Undefined function called: add_data_validation",
      "Undefined function called: min",
      "Undefined function called: Button",
      "Undefined function called: ceil",
      "Undefined function called: Border",
      "Undefined function called: append",
      "Undefined function called: strftime",
      "Undefined function called: extract_text",
      "Undefined function called: any",
      "Undefined function called: replace",
      "Undefined function called: HTML",
      "Undefined function called: DataFrame",
      "Undefined function called: enumerate",
      "Undefined function called: on_click",
      "Undefined function called: Comment",
      "Undefined function called: Counter",
      "Undefined function called: group",
      "Undefined function called: read_excel",
      "Undefined function called: rmtree",
      "Undefined function called: Alignment",
      "Undefined function called: join",
      "Undefined function called: apply",
      "Undefined function called: download_template",
      "Undefined function called: notna",
      "Undefined function called: sum",
      "Undefined function called: print_exc",
      "Undefined function called: close",
      "Undefined function called: basename",
      "Undefined function called: startswith",
      "Undefined function called: zfill",
      "Undefined function called: iter_rows",
      "Undefined function called: upload",
      "Undefined function called: to_datetime",
      "Undefined function called: strip",
      "Undefined function called: export_validation_report",
      "Undefined function called: load_workbook",
      "Undefined function called: most_common",
      "Undefined function called: Layout",
      "Undefined function called: DataValidation",
      "Undefined function called: create_sheet",
      "Undefined function called: object",
      "Undefined function called: ZipFile",
      "Undefined function called: validate_all",
      "Undefined function called: walk",
      "Undefined function called: items",
      "Undefined function called: format",
      "Undefined function called: filterwarnings",
      "Undefined function called: quantize",
      "Undefined function called: set",
      "Undefined function called: Decimal",
      "Undefined function called: get",
      "Undefined function called: strptime",
      "Undefined function called: ExcelWriter",
      "Undefined function called: VBox",
      "Undefined function called: search",
      "Undefined function called: Workbook",
      "Undefined function called: remove",
      "Undefined function called: endswith",
      "Undefined function called: Font",
      "Undefined function called: to_string",
      "Undefined function called: if",
      "Undefined function called: merge_cells",
      "Undefined function called: astype",
      "Undefined function called: add",
      "Undefined function called: exists",
      "Undefined function called: save_template"
    ],
    "mapping_issues": [],
    "fixed": []
  },
  "pdf_excel_flow": {},
  "test_coverage": {
    "test_functions": [
      "test_extraction",
      "test_template_generation",
      "test_validation",
      "test_reconciliation_report",
      "test_pdf_extraction_single",
      "test_pdf_deduplication",
      "test_tds_masters_reading",
      "test_date_extraction"
    ],
    "coverage_count": 8,
    "has_pdf_tests": true,
    "has_excel_tests": true,
    "has_validation_tests": true
  }
}