{
  "metadata": {
    "total_cells": 13,
    "notebook_path": "TDS_Automation_V2.ipynb",
    "last_scan": "2025-08-14T10:15:36.107281",
    "version": "3.0",
    "repository": "rjshvjy/tds-automation",
    "type": "widget_based",
    "flow_type": "branching",
    "commit_hash": "9a1292c99f3adad1ac39473671fea2a3e18c2bca"
  },
  "cells": {
    "cell_1": {
      "index": 1,
      "title": "Install required libraries and import modules",
      "status": "unknown",
      "imports": [
        "import PyPDF2",
        "import pandas as pd",
        "import numpy as np",
        "import re",
        "import os",
        "from datetime import datetime",
        "import openpyxl",
        "from openpyxl import load_workbook",
        "from openpyxl.utils import get_column_letter",
        "from openpyxl.styles import Font, Alignment, Border, Side",
        "import warnings"
      ],
      "defines": {
        "functions": [],
        "classes": []
      },
      "calls": [
        "print",
        "filterwarnings"
      ],
      "dependencies": {
        "backward": [],
        "forward": []
      },
      "issues": [],
      "mapping_related": false
    },
    "cell_2": {
      "index": 2,
      "title": "Functions to extract data from PDF challans - FIXED AMOUNT EXTRACTION",
      "status": "unknown",
      "imports": [],
      "defines": {
        "functions": [
          "extract_challan_data_from_pdf",
          "extract_all_challans",
          "test_extraction"
        ],
        "classes": []
      },
      "calls": [
        "sorted",
        "items",
        "listdir",
        "basename",
        "zfill",
        "test_extraction",
        "endswith",
        "strip",
        "extract_all_challans",
        "str",
        "group",
        "extract_text",
        "get",
        "len",
        "lower",
        "PdfReader",
        "join",
        "replace",
        "append",
        "search",
        "open",
        "upper",
        "print",
        "extract_challan_data_from_pdf",
        "float"
      ],
      "dependencies": {
        "backward": [],
        "forward": []
      },
      "issues": [
        "Contains leading_zeros pattern",
        "Contains string_preserve pattern"
      ],
      "mapping_related": true
    },
    "cell_3": {
      "index": 3,
      "title": "Functions to read and update Excel files - FIXED WITH PROPER COLUMN CODES AND TDS PRESERVATION",
      "status": "unknown",
      "imports": [
        "import math",
        "from decimal import Decimal, ROUND_HALF_UP",
        "import traceback",
        "import traceback",
        "import traceback"
      ],
      "defines": {
        "functions": [
          "read_tds_masters",
          "update_tds_masters_with_challans",
          "validate_tds_totals"
        ],
        "classes": []
      },
      "calls": [
        "astype",
        "Decimal",
        "load_workbook",
        "sorted",
        "close",
        "items",
        "startswith",
        "quantize",
        "apply",
        "match",
        "strip",
        "keys",
        "str",
        "save",
        "group",
        "get",
        "len",
        "cell",
        "range",
        "update_tds_masters_with_challans",
        "any",
        "min",
        "to_numeric",
        "notna",
        "lower",
        "iter_rows",
        "DataFrame",
        "abs",
        "append",
        "replace",
        "strptime",
        "int",
        "read_excel",
        "print_exc",
        "validate_tds_totals",
        "search",
        "iterrows",
        "to_datetime",
        "list",
        "read_tds_masters",
        "enumerate",
        "print",
        "set"
      ],
      "dependencies": {
        "backward": [],
        "forward": []
      },
      "issues": [
        "Contains nan_values pattern",
        "Contains date_format pattern",
        "Contains rate_conversion pattern",
        "Contains round_up pattern",
        "Contains string_preserve pattern"
      ],
      "mapping_related": true,
      "column_references": [
        "(415)",
        "(415A)",
        "(416)",
        "(417)",
        "(418)",
        "(419)",
        "(421)",
        "(425D)",
        "(425E)",
        "(425F)",
        "(427)"
      ]
    },
    "cell_4": {
      "index": 4,
      "title": "TDS_Masters Template Generator",
      "status": "unknown",
      "imports": [
        "import openpyxl",
        "from openpyxl import Workbook",
        "from openpyxl.styles import Font, Alignment, Border, Side, PatternFill",
        "from openpyxl.utils import get_column_letter",
        "from openpyxl.worksheet.datavalidation import DataValidation",
        "import pandas as pd",
        "from datetime import datetime",
        "import ipywidgets as widgets",
        "from IPython.display import display",
        "from google.colab import files"
      ],
      "defines": {
        "functions": [
          "generate_tds_masters_template",
          "create_template_download_widget"
        ],
        "classes": [
          "TDSMastersTemplateGenerator"
        ]
      },
      "calls": [
        "Workbook",
        "add_data_validation",
        "Layout",
        "download_template",
        "TDSMastersTemplateGenerator",
        "items",
        "generate_tds_masters_template",
        "create_sheet",
        "VBox",
        "_setup_deductor_input_sheet",
        "details",
        "on_click",
        "_setup_tds_parties_sheet",
        "date",
        "save",
        "download",
        "_setup_tds_codes_sheet",
        "cell",
        "range",
        "__init__",
        "create_template",
        "_setup_tds_rates_sheet",
        "now",
        "save_template",
        "create_template_download_widget",
        "HTML",
        "merge_cells",
        "Comment",
        "add",
        "get_column_letter",
        "Button",
        "Font",
        "DataValidation",
        "enumerate",
        "print",
        "PatternFill",
        "Alignment",
        "_setup_challan_details_sheet"
      ],
      "dependencies": {
        "backward": [],
        "forward": []
      },
      "issues": [
        "Contains nan_values pattern",
        "Contains leading_zeros pattern",
        "Contains date_format pattern",
        "Contains rate_conversion pattern"
      ],
      "mapping_related": false,
      "column_references": [
        "(415)",
        "(415A)",
        "(416)",
        "(417)",
        "(418)",
        "(419)",
        "(420)",
        "(421)",
        "(425D)",
        "(425E)",
        "(425F)",
        "(427)"
      ]
    },
    "cell_5": {
      "index": 5,
      "title": "Government Template Builder and Enhanced Output Generator",
      "status": "unknown",
      "imports": [
        "import openpyxl",
        "from openpyxl import Workbook",
        "from openpyxl.styles import Font, Alignment, Border, Side, PatternFill",
        "from openpyxl.utils import get_column_letter",
        "from decimal import Decimal, ROUND_HALF_UP",
        "import pandas as pd",
        "from datetime import datetime",
        "import math"
      ],
      "defines": {
        "functions": [
          "generate_output_file_enhanced",
          "test_template_generation"
        ],
        "classes": [
          "GovernmentTemplateBuilder"
        ]
      },
      "calls": [
        "Workbook",
        "fill_template",
        "float",
        "GovernmentTemplateBuilder",
        "create_sheet",
        "if",
        "dropna",
        "strip",
        "extract_all_challans",
        "str",
        "test_template_generation",
        "save",
        "generate_output_file_enhanced",
        "get",
        "len",
        "cell",
        "__init__",
        "_fill_challan_details",
        "create_template",
        "_setup_deductor_sheet",
        "notna",
        "ceil",
        "_fill_deductee_breakup",
        "isinstance",
        "append",
        "replace",
        "strptime",
        "get_column_letter",
        "int",
        "Font",
        "_fill_deductor_details",
        "iterrows",
        "to_datetime",
        "upper",
        "read_tds_masters",
        "_setup_deductee_sheet",
        "enumerate",
        "print",
        "Alignment",
        "_setup_challan_sheet"
      ],
      "dependencies": {
        "backward": [
          "cell_2",
          "cell_3"
        ],
        "forward": [
          "cell_9"
        ]
      },
      "issues": [
        "Contains nan_values pattern",
        "Contains date_format pattern",
        "Contains rate_conversion pattern",
        "Contains round_up pattern",
        "Contains string_preserve pattern"
      ],
      "mapping_related": true,
      "column_references": [
        "(415)",
        "(415A)",
        "(416)",
        "(417)",
        "(418)",
        "(419)",
        "(420)",
        "(421)",
        "(425D)",
        "(425E)",
        "(425F)",
        "(427)"
      ]
    },
    "cell_6": {
      "index": 6,
      "title": "Core Processing and Orchestration Functions",
      "status": "unknown",
      "imports": [
        "import os",
        "import pandas as pd",
        "import openpyxl",
        "from openpyxl.styles import Font, PatternFill, Border, Side, Alignment",
        "from openpyxl.utils import get_column_letter",
        "from datetime import datetime",
        "import warnings",
        "from GovernmentTemplateBuilder import generate_output_file_enhanced",
        "from GovernmentTemplateBuilder import GovernmentTemplateBuilder"
      ],
      "defines": {
        "functions": [
          "update_masters_with_challans",
          "save_updated_masters",
          "process_tds_automation",
          "fill_government_template",
          "test_validation_engine",
          "test_reconciliation_report"
        ],
        "classes": [
          "ValidationEngine",
          "ReconciliationReport"
        ]
      },
      "calls": [
        "Workbook",
        "fill_template",
        "items",
        "float",
        "GovernmentTemplateBuilder",
        "create_sheet",
        "dropna",
        "fillna",
        "details",
        "validate_pan_format",
        "_create_amount_reconciliation_sheet",
        "_create_validation_sheet",
        "extract_all_challans",
        "save_report",
        "str",
        "anymore",
        "save",
        "generate_output_file_enhanced",
        "test_reconciliation_report",
        "validate_tan_format",
        "get",
        "all",
        "len",
        "cell",
        "_create_summary_sheet",
        "range",
        "strftime",
        "__init__",
        "ReconciliationReport",
        "now",
        "create_report",
        "makedirs",
        "process_tds_automation",
        "sum",
        "print",
        "isinstance",
        "get_validation_report",
        "DataFrame",
        "join",
        "merge_cells",
        "append",
        "replace",
        "update_masters_with_challans",
        "_create_challan_matching_sheet",
        "ValidationEngine",
        "save_updated_masters",
        "test_validation_engine",
        "Font",
        "filterwarnings",
        "iterrows",
        "to_excel",
        "read_tds_masters",
        "ExcelWriter",
        "fill_government_template",
        "enumerate",
        "validate_mandatory_fields",
        "set"
      ],
      "dependencies": {
        "backward": [
          "cell_2",
          "cell_5",
          "cell_3"
        ],
        "forward": [
          "cell_8",
          "cell_9",
          "cell_7"
        ]
      },
      "issues": [
        "Contains nan_values pattern",
        "Contains date_format pattern",
        "Contains rate_conversion pattern",
        "Contains string_preserve pattern"
      ],
      "mapping_related": true,
      "column_references": [
        "(415A)",
        "(416)",
        "(417)",
        "(421)",
        "(425D)",
        "(425E)",
        "(425F)"
      ]
    },
    "cell_7": {
      "index": 7,
      "title": "Validation Engine with Reconciliation Report Support",
      "status": "unknown",
      "imports": [
        "import re",
        "import pandas as pd",
        "import openpyxl",
        "from openpyxl import load_workbook",
        "from datetime import datetime",
        "from decimal import Decimal, ROUND_HALF_UP",
        "import numpy as np"
      ],
      "defines": {
        "functions": [
          "test_validation"
        ],
        "classes": [
          "ValidationEngine"
        ]
      },
      "calls": [
        "_validate_pincode",
        "Decimal",
        "load_workbook",
        "sorted",
        "items",
        "float",
        "_generate_summary",
        "validator",
        "export_validation_report",
        "quantize",
        "match",
        "title",
        "validate_all",
        "_load_deductor_details",
        "strip",
        "keys",
        "str",
        "get",
        "_validate_pan",
        "len",
        "test_validation",
        "strftime",
        "get_validation_dataframe",
        "_validate_tan",
        "_reconcile_amounts",
        "__init__",
        "_validate_formats",
        "now",
        "notna",
        "values",
        "_validate_quarter",
        "sum",
        "_validate_mandatory_fields",
        "DataFrame",
        "abs",
        "append",
        "replace",
        "_validate_email",
        "ValidationEngine",
        "iterrows",
        "list",
        "to_excel",
        "to_string",
        "upper",
        "_validate_yes_no",
        "ExcelWriter",
        "_generate_suggestions",
        "enumerate",
        "print",
        "_validate_deductor_type",
        "set"
      ],
      "dependencies": {
        "backward": [],
        "forward": []
      },
      "issues": [
        "Contains nan_values pattern",
        "Contains date_format pattern",
        "Contains rate_conversion pattern",
        "Contains round_up pattern",
        "Contains string_preserve pattern"
      ],
      "mapping_related": true,
      "column_references": [
        "(415A)",
        "(416)",
        "(417)",
        "(421)"
      ]
    },
    "cell_8": {
      "index": 8,
      "title": "Reconciliation Report Generator",
      "status": "unknown",
      "imports": [
        "import pandas as pd",
        "import openpyxl",
        "from openpyxl import Workbook",
        "from openpyxl.styles import Font, Alignment, Border, Side, PatternFill",
        "from openpyxl.utils import get_column_letter",
        "from openpyxl.formatting.rule import CellIsRule",
        "from openpyxl.styles.differential import DifferentialStyle",
        "from datetime import datetime",
        "import numpy as np"
      ],
      "defines": {
        "functions": [
          "test_reconciliation_report"
        ],
        "classes": [
          "ReconciliationReport"
        ]
      },
      "calls": [
        "Workbook",
        "generate_report",
        "items",
        "create_sheet",
        "Side",
        "_get_format_suggestion",
        "_create_mandatory_fields_sheet",
        "remove",
        "Border",
        "title",
        "save",
        "_create_validation_errors_sheet",
        "test_reconciliation_report",
        "get",
        "else",
        "len",
        "cell",
        "_create_summary_sheet",
        "range",
        "strftime",
        "__init__",
        "ReconciliationReport",
        "now",
        "values",
        "_print_report_summary",
        "sum",
        "_create_data_corrections_sheet",
        "merge_cells",
        "abs",
        "append",
        "_create_challan_matching_sheet",
        "Font",
        "enumerate",
        "print",
        "PatternFill",
        "Alignment"
      ],
      "dependencies": {
        "backward": [],
        "forward": []
      },
      "issues": [
        "Contains date_format pattern",
        "Contains rate_conversion pattern"
      ],
      "mapping_related": true,
      "column_references": [
        "(416)",
        "(417)"
      ]
    },
    "cell_9": {
      "index": 9,
      "title": "Enhanced Main Processing Pipeline",
      "status": "unknown",
      "imports": [
        "import os",
        "import math",
        "import pandas as pd",
        "import numpy as np",
        "from datetime import datetime",
        "from decimal import Decimal, ROUND_HALF_UP",
        "import openpyxl",
        "from openpyxl import load_workbook, Workbook",
        "from openpyxl.utils import get_column_letter",
        "from openpyxl.styles import Font, Alignment, Border, Side, PatternFill"
      ],
      "defines": {
        "functions": [
          "get_output_filename_from_masters",
          "fill_government_template",
          "_fill_deductor_details",
          "_fill_challan_details",
          "_fill_deductee_breakup",
          "process_tds_returns_enhanced",
          "process_tds_returns"
        ],
        "classes": []
      },
      "calls": [
        "Workbook",
        "fill_template",
        "Decimal",
        "generate_report",
        "float",
        "to_pydatetime",
        "GovernmentTemplateBuilder",
        "create_sheet",
        "dropna",
        "quantize",
        "dirname",
        "remove",
        "validate_all",
        "strip",
        "extract_all_challans",
        "str",
        "save",
        "get",
        "len",
        "cell",
        "range",
        "strftime",
        "update_tds_masters_with_challans",
        "_fill_challan_details",
        "ReconciliationReport",
        "create_template",
        "now",
        "notna",
        "process_tds_returns",
        "process_tds_returns_enhanced",
        "_fill_deductee_breakup",
        "isinstance",
        "join",
        "replace",
        "strptime",
        "ValidationEngine",
        "int",
        "Font",
        "_fill_deductor_details",
        "iterrows",
        "validate_tds_totals",
        "to_datetime",
        "read_tds_masters",
        "fill_government_template",
        "enumerate",
        "print",
        "get_output_filename_from_masters"
      ],
      "dependencies": {
        "backward": [
          "cell_8",
          "cell_5",
          "cell_3",
          "cell_7",
          "cell_2"
        ],
        "forward": []
      },
      "issues": [
        "Contains nan_values pattern",
        "Contains date_format pattern",
        "Contains rate_conversion pattern",
        "Contains round_up pattern",
        "Contains string_preserve pattern"
      ],
      "mapping_related": true,
      "column_references": [
        "(415)",
        "(415A)",
        "(416)",
        "(417)",
        "(418)",
        "(419)",
        "(420)",
        "(421)",
        "(425D)",
        "(427)"
      ]
    },
    "cell_10": {
      "index": 10,
      "title": "Modified Interactive Interface - 2-File Upload System",
      "status": "unknown",
      "imports": [
        "import os",
        "import zipfile",
        "import shutil",
        "from google.colab import files",
        "import pandas as pd",
        "from datetime import datetime",
        "import time",
        "import traceback"
      ],
      "defines": {
        "functions": [
          "clear_uploads",
          "upload_zip_file",
          "process_uploaded_files",
          "start_interactive_upload",
          "download_tds_masters_template"
        ],
        "classes": []
      },
      "calls": [
        "start_interactive_upload",
        "TDSMastersTemplateGenerator",
        "items",
        "ZipFile",
        "startswith",
        "upload_zip_file",
        "move",
        "basename",
        "endswith",
        "walk",
        "remove",
        "upload",
        "extractall",
        "format",
        "save",
        "download",
        "get",
        "len",
        "create_template",
        "lower",
        "makedirs",
        "process_uploaded_files",
        "rmtree",
        "process_tds_returns_enhanced",
        "join",
        "download_tds_masters_template",
        "append",
        "write",
        "exists",
        "print_exc",
        "clear_uploads",
        "open",
        "print",
        "extract_challan_data_from_pdf"
      ],
      "dependencies": {
        "backward": [
          "cell_9",
          "cell_2",
          "cell_4"
        ],
        "forward": []
      },
      "issues": [
        "Contains leading_zeros pattern",
        "Contains rate_conversion pattern",
        "Contains round_up pattern",
        "Contains string_preserve pattern"
      ],
      "mapping_related": true,
      "column_references": [
        "(427)"
      ]
    },
    "cell_11": {
      "index": 11,
      "title": "Testing individual components and troubleshooting - FIXED VERSION",
      "status": "unknown",
      "imports": [
        "from collections import Counter"
      ],
      "defines": {
        "functions": [
          "test_pdf_extraction_single",
          "test_pdf_deduplication",
          "test_tds_masters_reading",
          "test_date_extraction",
          "create_test_summary"
        ],
        "classes": []
      },
      "calls": [
        "sorted",
        "items",
        "float",
        "listdir",
        "dropna",
        "endswith",
        "extract_all_challans",
        "strip",
        "str",
        "get",
        "test_pdf_deduplication",
        "notna",
        "create_test_summary",
        "lower",
        "ceil",
        "most_common",
        "test_date_extraction",
        "test_pdf_extraction_single",
        "join",
        "abs",
        "append",
        "replace",
        "head",
        "iterrows",
        "to_datetime",
        "read_tds_masters",
        "Counter",
        "enumerate",
        "print",
        "extract_challan_data_from_pdf",
        "test_tds_masters_reading",
        "get_output_filename_from_masters"
      ],
      "dependencies": {
        "backward": [
          "cell_9",
          "cell_2",
          "cell_3"
        ],
        "forward": []
      },
      "issues": [
        "Contains nan_values pattern",
        "Contains leading_zeros pattern",
        "Contains date_format pattern",
        "Contains rate_conversion pattern",
        "Contains round_up pattern",
        "Contains string_preserve pattern"
      ],
      "mapping_related": true,
      "column_references": [
        "(415)",
        "(415A)",
        "(416)",
        "(417)",
        "(418)",
        "(419)",
        "(421)",
        "(427)"
      ]
    },
    "cell_12": {
      "index": 12,
      "title": "Main Execution Cell - Simple Interface",
      "status": "unknown",
      "imports": [],
      "defines": {
        "functions": [
          "quick_start"
        ],
        "classes": []
      },
      "calls": [
        "exists",
        "start_interactive_upload",
        "get",
        "quick_start",
        "listdir",
        "len",
        "print",
        "endswith"
      ],
      "dependencies": {
        "backward": [
          "cell_10"
        ],
        "forward": []
      },
      "issues": [],
      "mapping_related": false
    }
  },
  "dependency_graph": {
    "execution_order": [
      1,
      2,
      3,
      4,
      5,
      6,
      7,
      8,
      9,
      10,
      11,
      12
    ],
    "definitions": {
      "extract_challan_data_from_pdf": "cell_2",
      "extract_all_challans": "cell_2",
      "test_extraction": "cell_2",
      "read_tds_masters": "cell_3",
      "update_tds_masters_with_challans": "cell_3",
      "validate_tds_totals": "cell_3",
      "generate_tds_masters_template": "cell_4",
      "create_template_download_widget": "cell_4",
      "TDSMastersTemplateGenerator": "cell_4",
      "generate_output_file_enhanced": "cell_5",
      "test_template_generation": "cell_5",
      "GovernmentTemplateBuilder": "cell_5",
      "update_masters_with_challans": "cell_6",
      "save_updated_masters": "cell_6",
      "process_tds_automation": "cell_6",
      "fill_government_template": "cell_9",
      "test_validation_engine": "cell_6",
      "test_reconciliation_report": "cell_8",
      "ValidationEngine": "cell_7",
      "ReconciliationReport": "cell_8",
      "test_validation": "cell_7",
      "get_output_filename_from_masters": "cell_9",
      "_fill_deductor_details": "cell_9",
      "_fill_challan_details": "cell_9",
      "_fill_deductee_breakup": "cell_9",
      "process_tds_returns_enhanced": "cell_9",
      "process_tds_returns": "cell_9",
      "clear_uploads": "cell_10",
      "upload_zip_file": "cell_10",
      "process_uploaded_files": "cell_10",
      "start_interactive_upload": "cell_10",
      "download_tds_masters_template": "cell_10",
      "test_pdf_extraction_single": "cell_11",
      "test_pdf_deduplication": "cell_11",
      "test_tds_masters_reading": "cell_11",
      "test_date_extraction": "cell_11",
      "create_test_summary": "cell_11",
      "quick_start": "cell_12"
    },
    "forward_dependencies": 2
  },
  "mapping_pipeline": {
    "pdf_extraction": {
      "functions": [
        {
          "cell": "cell_2",
          "functions": [
            "extract_challan_data_from_pdf",
            "extract_all_challans",
            "test_extraction"
          ]
        },
        {
          "cell": "cell_10",
          "functions": [
            "clear_uploads",
            "upload_zip_file",
            "process_uploaded_files",
            "start_interactive_upload",
            "download_tds_masters_template"
          ]
        },
        {
          "cell": "cell_11",
          "functions": [
            "test_pdf_extraction_single",
            "test_pdf_deduplication",
            "test_tds_masters_reading",
            "test_date_extraction",
            "create_test_summary"
          ]
        }
      ],
      "input_fields": [
        "bsr_code",
        "challan_no",
        "bsr_code",
        "challan_no",
        "bsr_code",
        "challan_no",
        "challan_no",
        "challan_no",
        "challan_no",
        "challan_no",
        "challan_no"
      ],
      "output_structure": {},
      "issues": []
    },
    "excel_processing": {
      "functions": [
        {
          "cell": "cell_1",
          "functions": []
        },
        {
          "cell": "cell_3",
          "functions": [
            "read_tds_masters",
            "update_tds_masters_with_challans",
            "validate_tds_totals"
          ]
        },
        {
          "cell": "cell_4",
          "functions": [
            "generate_tds_masters_template",
            "create_template_download_widget"
          ]
        },
        {
          "cell": "cell_5",
          "functions": [
            "generate_output_file_enhanced",
            "test_template_generation"
          ]
        },
        {
          "cell": "cell_6",
          "functions": [
            "update_masters_with_challans",
            "save_updated_masters",
            "process_tds_automation",
            "fill_government_template",
            "test_validation_engine",
            "test_reconciliation_report"
          ]
        },
        {
          "cell": "cell_7",
          "functions": [
            "test_validation"
          ]
        },
        {
          "cell": "cell_8",
          "functions": [
            "test_reconciliation_report"
          ]
        },
        {
          "cell": "cell_9",
          "functions": [
            "get_output_filename_from_masters",
            "fill_government_template",
            "_fill_deductor_details",
            "_fill_challan_details",
            "_fill_deductee_breakup",
            "process_tds_returns_enhanced",
            "process_tds_returns"
          ]
        },
        {
          "cell": "cell_10",
          "functions": [
            "clear_uploads",
            "upload_zip_file",
            "process_uploaded_files",
            "start_interactive_upload",
            "download_tds_masters_template"
          ]
        },
        {
          "cell": "cell_11",
          "functions": [
            "test_pdf_extraction_single",
            "test_pdf_deduplication",
            "test_tds_masters_reading",
            "test_date_extraction",
            "create_test_summary"
          ]
        },
        {
          "cell": "cell_12",
          "functions": [
            "quick_start"
          ]
        }
      ],
      "column_mappings": {
        "(415)": "Deductee Code",
        "(415A)": "Section/Nature of Payment",
        "(416)": "PAN",
        "(417)": "Name",
        "(418)": "Date of Payment",
        "(419)": "Amount Paid",
        "(420)": "Paid by Book Entry",
        "(421)": "TDS Amount",
        "(425D)": "BSR Code",
        "(425E)": "Challan Serial No",
        "(425F)": "Date Deposited",
        "(427)": "Rate"
      },
      "transformations": [
        "Amount rounding up",
        "Date formatting",
        "Date formatting",
        "Amount rounding up",
        "Date formatting",
        "Date formatting",
        "Amount rounding up",
        "Date formatting",
        "Date formatting",
        "Amount rounding up",
        "Date formatting",
        "Date formatting"
      ],
      "issues": []
    },
    "validation": {
      "mandatory_fields": 20,
      "validation_functions": [
        {
          "cell": "cell_3",
          "functions": [
            "read_tds_masters",
            "update_tds_masters_with_challans",
            "validate_tds_totals"
          ]
        },
        {
          "cell": "cell_6",
          "functions": [
            "update_masters_with_challans",
            "save_updated_masters",
            "process_tds_automation",
            "fill_government_template",
            "test_validation_engine",
            "test_reconciliation_report"
          ]
        },
        {
          "cell": "cell_7",
          "functions": [
            "test_validation"
          ]
        },
        {
          "cell": "cell_8",
          "functions": [
            "test_reconciliation_report"
          ]
        },
        {
          "cell": "cell_9",
          "functions": [
            "get_output_filename_from_masters",
            "fill_government_template",
            "_fill_deductor_details",
            "_fill_challan_details",
            "_fill_deductee_breakup",
            "process_tds_returns_enhanced",
            "process_tds_returns"
          ]
        }
      ],
      "issues": []
    }
  },
  "issues": {
    "critical": [],
    "warnings": [
      "Cell 5: Forward dependency on _fill_challan_details defined in Cell 9",
      "Cell 5: Forward dependency on _fill_deductee_breakup defined in Cell 9",
      "Cell 5: Forward dependency on _fill_deductor_details defined in Cell 9",
      "Cell 6: Forward dependency on test_reconciliation_report defined in Cell 8",
      "Cell 6: Forward dependency on ReconciliationReport defined in Cell 8",
      "Cell 6: Forward dependency on ValidationEngine defined in Cell 7",
      "Cell 6: Forward dependency on fill_government_template defined in Cell 9",
      "Undefined function called: Workbook",
      "Undefined function called: astype",
      "Undefined function called: VBox",
      "Undefined function called: export_validation_report",
      "Undefined function called: listdir",
      "Undefined function called: dropna",
      "Undefined function called: endswith",
      "Undefined function called: quantize",
      "Undefined function called: walk",
      "Undefined function called: upload",
      "Undefined function called: keys",
      "Undefined function called: get",
      "Undefined function called: cell",
      "Undefined function called: strftime",
      "Undefined function called: any",
      "Undefined function called: min",
      "Undefined function called: to_numeric",
      "Undefined function called: lower",
      "Undefined function called: rmtree",
      "Undefined function called: values",
      "Undefined function called: PdfReader",
      "Undefined function called: sum",
      "Undefined function called: DataFrame",
      "Undefined function called: join",
      "Undefined function called: strptime",
      "Undefined function called: read_excel",
      "Undefined function called: filterwarnings",
      "Undefined function called: to_datetime",
      "Undefined function called: ExcelWriter",
      "Undefined function called: download_template",
      "Undefined function called: validate_mandatory_fields",
      "Undefined function called: PatternFill",
      "Undefined function called: Alignment",
      "Undefined function called: Decimal",
      "Undefined function called: validator",
      "Undefined function called: details",
      "Undefined function called: dirname",
      "Undefined function called: Border",
      "Undefined function called: extractall",
      "Undefined function called: validate_all",
      "Undefined function called: save",
      "Undefined function called: group",
      "Undefined function called: get_validation_dataframe",
      "Undefined function called: ceil",
      "Undefined function called: create_report",
      "Undefined function called: makedirs",
      "Undefined function called: exists",
      "Undefined function called: list",
      "Undefined function called: search",
      "Undefined function called: add_data_validation",
      "Undefined function called: fill_template",
      "Undefined function called: Layout",
      "Undefined function called: items",
      "Undefined function called: to_pydatetime",
      "Undefined function called: move",
      "Undefined function called: zfill",
      "Undefined function called: fillna",
      "Undefined function called: validate_pan_format",
      "Undefined function called: remove",
      "Undefined function called: on_click",
      "Undefined function called: title",
      "Undefined function called: anymore",
      "Undefined function called: extract_text",
      "Undefined function called: all",
      "Undefined function called: else",
      "Undefined function called: create_template",
      "Undefined function called: notna",
      "Undefined function called: iter_rows",
      "Undefined function called: get_validation_report",
      "Undefined function called: merge_cells",
      "Undefined function called: replace",
      "Undefined function called: append",
      "Undefined function called: Comment",
      "Undefined function called: get_column_letter",
      "Undefined function called: DataValidation",
      "Undefined function called: to_string",
      "Undefined function called: sorted",
      "Undefined function called: load_workbook",
      "Undefined function called: generate_report",
      "Undefined function called: close",
      "Undefined function called: create_sheet",
      "Undefined function called: startswith",
      "Undefined function called: if",
      "Undefined function called: ZipFile",
      "Undefined function called: Side",
      "Undefined function called: basename",
      "Undefined function called: apply",
      "Undefined function called: match",
      "Undefined function called: strip",
      "Undefined function called: save_report",
      "Undefined function called: date",
      "Undefined function called: format",
      "Undefined function called: download",
      "Undefined function called: validate_tan_format",
      "Undefined function called: now",
      "Undefined function called: save_template",
      "Undefined function called: HTML",
      "Undefined function called: most_common",
      "Undefined function called: abs",
      "Undefined function called: write",
      "Undefined function called: add",
      "Undefined function called: Button",
      "Undefined function called: head",
      "Undefined function called: print_exc",
      "Undefined function called: Font",
      "Undefined function called: iterrows",
      "Undefined function called: to_excel",
      "Undefined function called: upper",
      "Undefined function called: Counter",
      "Undefined function called: enumerate",
      "Undefined function called: set"
    ],
    "mapping_issues": [],
    "fixed": []
  },
  "pdf_excel_flow": {},
  "test_coverage": {
    "test_functions": [
      "test_extraction",
      "test_template_generation",
      "test_validation_engine",
      "test_reconciliation_report",
      "test_validation",
      "test_reconciliation_report",
      "test_pdf_extraction_single",
      "test_pdf_deduplication",
      "test_tds_masters_reading",
      "test_date_extraction"
    ],
    "coverage_count": 10,
    "has_pdf_tests": true,
    "has_excel_tests": true,
    "has_validation_tests": true
  }
}